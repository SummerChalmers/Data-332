library(tidytext)
library(textdata)
library(ggplot2)
library(janeaustenr)
library(dplyr)
library(stringr)
library(tidyr)
library(wordcloud)
library(tidyr)
library(tidyverse)
library(readxl)

setwd('H:/Data332/ConsumerComplaint')
consumer_complaints <- read.csv('Consumer_Complaints.csv')

get_sentiments("afinn")
get_sentiments("bing")
get_sentiments("nrc")

#sentiment analysis
data <- consumer_complaints %>%
  mutate(text = tolower(text)) %>%  # Convert text to lowercase
  unnest_tokens(word, text)         # Tokenize the text into words
data <- data %>%
  inner_join(get_sentiments("afinn"), by = "word") %>%
  group_by(Product) %>%
  summarise(sentiment_score = sum(value)) %>%
  ungroup()

#word cloud
text_corpus <- data$text
text_corpus <- tolower(text_corpus)  # Convert text to lowercase
text_corpus <- removePunctuation(text_corpus)  # Remove punctuation
text_corpus <- removeNumbers(text_corpus)  # Remove numbers
wordcloud(text_corpus, min.freq = 5, random.order = FALSE)
